CREATE TABLE PROFILE_PICTURE
  (
    PICTURE_ID SMALLINT NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1),
    PICTURE    VARCHAR(255) NOT NULL,
    PRIMARY KEY (PICTURE_ID)
  );

CREATE TABLE ADMIN
  (
    USERNAME     VARCHAR(32) NOT NULL,
    FIRST_NAME   VARCHAR(35) NOT NULL,
    LAST_NAME    VARCHAR(35) NOT NULL,
    PHONE_NUMBER CHAR(11) NOT NULL,
    EMAIL        VARCHAR(320) NOT NULL,
    PICTURE_ID   SMALLINT,
    PRIMARY KEY (USERNAME),
    FOREIGN KEY (PICTURE_ID) REFERENCES PROFILE_PICTURE(PICTURE_ID)
  );

CREATE TABLE USER
  (
    USER_ID      INT NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1),
    FIRST_NAME   VARCHAR(35) NOT NULL,
    LAST_NAME    VARCHAR(35) NOT NULL,
    PHONE_NUMBER CHAR(11) NOT NULL,
    PREFIX       VARCHAR(5) NOT NULL,
    PICTURE_ID   SMALLINT,
    PRIMARY KEY (USER_ID),
    FOREIGN KEY (PICTURE_ID) REFERENCES PROFILE_PICTURE(PICTURE_ID)
  );

CREATE TABLE SERVICE
  (
    SERVICE_ID INT NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1),
    NAME       VARCHAR(30) NOT NULL,
    CATEGORY   VARCHAR(20) NOT NULL,
    ICON       VARCHAR(255),
    DESCRIPTION VARCHAR(255) NOT NULL,
    PRIMARY KEY (SERVICE_ID)
  );

CREATE TABLE SERVICE_LOG
  (
    SERVICE_ID INT NOT NULL,
    USER_ID INT NOT NULL,
    LOG_DATE   DATE NOT NULL,
    LOG_TIME   TIME NOT NULL,
    PRIMARY KEY (SERVICE_ID, USER_ID),
    FOREIGN KEY (SERVICE_ID) REFERENCES SERVICE(SERVICE_ID),
     FOREIGN KEY (USER_ID) REFERENCES USER(USER_ID)
  );
  
CREATE TABLE ADMIN_CIRCLE
  (
    USERNAME VARCHAR(32) NOT NULL,
    USER_ID  INT NOT NULL,
    PRIMARY KEY (USERNAME, USER_ID),
    FOREIGN KEY (USERNAME) REFERENCES ADMIN(USERNAME),
    FOREIGN KEY (USER_ID) REFERENCES USER(USER_ID)
  );

CREATE TABLE USER_SERVICE
  (
    SERVICE_ID INT NOT NULL,
    USER_ID    INT NOT NULL,
    PRIMARY KEY (SERVICE_ID, USER_ID),
    FOREIGN KEY (SERVICE_ID) REFERENCES SERVICE(SERVICE_ID),
    FOREIGN KEY (USER_ID) REFERENCES USER(USER_ID)
  );
